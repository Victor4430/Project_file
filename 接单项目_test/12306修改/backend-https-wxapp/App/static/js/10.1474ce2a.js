(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"5G+f":function(e,t,r){},Boxv:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[r("Icon",{attrs:{type:"person"}}),e._v("个人信息\n      ")],1),e._v(" "),r("Row",[r("i-col",{attrs:{span:"12"}},[r("Form",{ref:"userForm",attrs:{model:e.user_compute,"label-width":100,"label-position":"right",rules:e.inforValidate}},[r("FormItem",{attrs:{label:"工号："}},[r("h3",[e._v(e._s(e.user_compute.staffcode))])]),e._v(" "),r("FormItem",{attrs:{label:"用户姓名："}},[r("div",{staticStyle:{display:"inline-block",width:"300px"}},[r("h3",[e._v(e._s(e.user_compute.realname))])])]),e._v(" "),r("FormItem",{attrs:{label:"登录密码："}},[r("Button",{on:{click:e.showEditPassword}},[e._v("修改密码")])],1),e._v(" "),r("div")],1)],1),e._v(" "),r("i-col",{attrs:{span:"12"}},[r("div",{staticClass:"cropper-example cropper-first"},[r("cropper",{attrs:{src:e.exampleImageSrc,"crop-button-text":"确认提交"},on:{"on-crop":e.handleCroped}})],1)])],1)],1),e._v(" "),r("Modal",{attrs:{closable:!1,"mask-closable":!1,width:500},model:{value:e.editPasswordModal,callback:function(t){e.editPasswordModal=t},expression:"editPasswordModal"}},[r("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[e._v("修改密码")]),e._v(" "),r("Form",{ref:"editPasswordForm",attrs:{model:e.editPasswordForm,"label-width":100,"label-position":"right",rules:e.passwordValidate}},[r("FormItem",{attrs:{label:"原密码",prop:"oldPass",error:e.oldPassError}},[r("Input",{attrs:{placeholder:"请输入现在使用的密码"},model:{value:e.editPasswordForm.oldPass,callback:function(t){e.$set(e.editPasswordForm,"oldPass",t)},expression:"editPasswordForm.oldPass"}})],1),e._v(" "),r("FormItem",{attrs:{label:"新密码",prop:"newPass"}},[r("Input",{attrs:{placeholder:"请输入新密码，至少6位字符"},model:{value:e.editPasswordForm.newPass,callback:function(t){e.$set(e.editPasswordForm,"newPass",t)},expression:"editPasswordForm.newPass"}})],1),e._v(" "),r("FormItem",{attrs:{label:"确认新密码",prop:"rePass"}},[r("Input",{attrs:{placeholder:"请再次输入新密码"},model:{value:e.editPasswordForm.rePass,callback:function(t){e.$set(e.editPasswordForm,"rePass",t)},expression:"editPasswordForm.rePass"}})],1)],1),e._v(" "),r("div",{attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"text"},on:{click:function(t){e.cancelEditPass("editPasswordForm")}}},[e._v("取消")]),e._v(" "),r("Button",{attrs:{type:"primary",loading:e.savePassLoading},on:{click:function(t){e.saveEditPass("editPasswordForm")}}},[e._v("保存")])],1)],1)],1)},o=[],a=(r("f3/d"),r("yT7P")),i=r("L2JU"),n=r("ccJ5"),c=r("Zt8a"),d=c["a"].fileaxios,l=function(e){return d.request({url:"get_uploadfile_data",method:"post",data:e})},p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"cropper-wrapper"},[r("Row",[r("i-col",{staticClass:"img-box",attrs:{span:16}},[r("img",{staticClass:"cropper-image",attrs:{id:e.imgId,alt:""}})]),e._v(" "),r("i-col",{staticClass:"right-con",attrs:{span:8}},[e.preview?r("div",{staticClass:"preview-box",attrs:{id:e.previewId}}):e._e(),e._v(" "),r("div",{staticClass:"button-box"},[e._t("default",[r("Upload",{attrs:{action:"image/upload","before-upload":e.beforeUpload}},[r("Button",{staticStyle:{width:"150px"},attrs:{type:"primary"}},[e._v("选择图片")])],1)]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.insideSrc,expression:"insideSrc"}]},[r("Button",{attrs:{type:"primary"},on:{click:e.rotate}},[r("Icon",{attrs:{type:"md-refresh",size:15}})],1),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:e.shrink}},[r("Icon",{attrs:{type:"md-remove",size:15}})],1),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:e.magnify}},[r("Icon",{attrs:{type:"md-add",size:15}})],1),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:function(t){e.scale("X")}}},[r("Icon",{attrs:{type:"ios-crop",size:15}})],1),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:function(t){e.scale("Y")}}},[r("Icon",{attrs:{type:"md-crop",size:15}})],1),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:function(t){e.move(0,-e.moveStep)}}},[r("Icon",{attrs:{type:"md-arrow-round-up",size:15}})],1),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:function(t){e.move(-e.moveStep,0)}}},[r("Icon",{attrs:{type:"md-arrow-round-back",size:15}})],1),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:function(t){e.move(0,e.moveStep)}}},[r("Icon",{attrs:{type:"md-arrow-round-down",size:15}})],1),e._v(" "),r("Button",{attrs:{type:"primary"},on:{click:function(t){e.move(e.moveStep,0)}}},[r("Icon",{attrs:{type:"md-arrow-round-forward",size:15}})],1),e._v(" "),r("Button",{staticStyle:{width:"150px","margin-top":"10px"},attrs:{type:"primary"},on:{click:e.crop}},[e._v(e._s(e.cropButtonText))])],1)],2)])],1)],1)},u=[],m=(r("pIFo"),r("urRO")),f=r.n(m),h=(r("oPLn"),r("RgTD"),{name:"Cropper",props:{src:{type:String,default:""},preview:{type:Boolean,default:!0},moveStep:{type:Number,default:4},cropButtonText:{type:String,default:"裁剪"}},data:function(){return{cropper:null,insideSrc:""}},computed:{imgId:function(){return"cropper".concat(this._uid)},previewId:function(){return"cropper_preview".concat(this._uid)}},watch:{src:function(e){this.replace(e)},insideSrc:function(e){this.replace(e)}},methods:{beforeUpload:function(e){var t=this,r=new FileReader;return r.readAsDataURL(e),r.onload=function(e){t.insideSrc=e.srcElement.result},!1},replace:function(e){this.cropper.replace(e),this.insideSrc=e},rotate:function(){this.cropper.rotate(90)},shrink:function(){this.cropper.zoom(-.1)},magnify:function(){this.cropper.zoom(.1)},scale:function(e){this.cropper["scale".concat(e)](-this.cropper.getData()["scale".concat(e)])},move:function(){var e;(e=this.cropper).move.apply(e,arguments)},crop:function(){var e=this;this.cropper.getCroppedCanvas().toBlob(function(t){e.$emit("on-crop",t)})}},mounted:function(){var e=this;this.$nextTick(function(){var t=document.getElementById(e.imgId);e.cropper=new f.a(t,{preview:"#".concat(e.previewId),checkCrossOrigin:!0})})}}),v=h,g=r("KHd+"),w=Object(g["a"])(v,p,u,!1,null,null,null),y=w.exports,P=y,I=(c["a"].axios,{name:"ownspace_index",components:{Cropper:P},data:function(){var e=this,t=function(e,t,r){var s=/^1[0-9]{10}$/;s.test(t)?r():r(new Error("请输入正确格式的手机号"))},r=function(t,r,s){r!==e.editPasswordForm.newPass?s(new Error("两次输入密码不一致")):s()},s=function(e,t,r){var s=/^[A-Za-z0-9_^%&',;=?$!@\x22]{6,32}$/;s.test(t)?r():r(new Error("密码格式错误，仅能为数字、符号和字母"))};return{exampleImageSrc:"",userForm:{id:"",staffcode:"",name:"",cellphone:""},userList:[],uid:"",securityCode:"",phoneHasChanged:!1,save_loading:!1,identifyError:"",editPasswordModal:!1,savePassLoading:!1,oldPassError:"",identifyCodeRight:!1,hasGetIdentifyCode:!1,canGetIdentifyCode:!1,checkIdentifyCodeLoading:!1,inforValidate:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],cellphone:[{required:!0,message:"请输入手机号码"},{validator:t}]},editPasswordForm:{oldPass:"",newPass:"",rePass:""},passwordValidate:{oldPass:[{required:!0,message:"请输入原密码",trigger:"blur"},{validator:s,trigger:"blur"}],newPass:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"请至少输入6个字符",trigger:"blur"},{max:32,message:"最多输入32个字符",trigger:"blur"},{validator:s,trigger:"blur"}],rePass:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:r,trigger:"blur"}]},inputCodeVisible:!1,initPhone:"",gettingIdentifyCodeBtnContent:"获取验证码"}},computed:{user_compute:{get:function(){var e=this.$store.state.user.userId,t=this.userList.filter(function(t){return t.id===e})[0]||{};return t}}},methods:Object(a["a"])({},Object(i["b"])(["handleUpdateAva"]),{handleCroped:function(e){var t=this,r=new FormData;r.append("file",e),l(r).then(function(e){t.$store.dispatch("handleUpdateAva",{form:{newpic:e.data.data}}).then(function(e){t.exampleImageSrc=t.$store.state.user.avatorImgPath,t.$Message.success("上传成功!")}).catch(function(e){t.$Message.error("上传失败")})}).catch(function(e){t.$Message.error(e)})},findName:function(e,t){if(e.nodeKey+""===t)return e.title;if(e.children){for(var r=0;r<e.children.length;r++){var s=this.findName(e.children[r],t);if(s)return s}return!1}return!1},getIdentifyCode:function(){var e=this;this.hasGetIdentifyCode=!0,this.$refs["userForm"].validate(function(t){if(t){e.canGetIdentifyCode=!0;var r=60,s=setInterval(function(){r>=0?(e.gettingIdentifyCodeBtnContent=r+"秒后重试",r-=1):(clearInterval(s),e.gettingIdentifyCodeBtnContent="获取验证码",e.canGetIdentifyCode=!1)},1e3);e.inputCodeVisible=!0}})},showEditPassword:function(){this.editPasswordModal=!0},cancelEditUserInfor:function(){this.$store.commit("removeTag","ownspace_index"),localStorage.pageOpenedList=JSON.stringify(this.$store.state.app.pageOpenedList);var e="";e=this.$store.state.app.pageOpenedList.length>1?this.$store.state.app.pageOpenedList[1].name:this.$store.state.app.pageOpenedList[0].name,this.$router.push({name:e})},saveEdit:function(){var e=this;this.$refs["userForm"].validate(function(t){t&&(e.phoneHasChanged&&e.userForm.cellphone!==e.initPhone?e.hasGetIdentifyCode?e.identifyCodeRight?e.saveInfoAjax():e.$Message.error("验证码错误，请重新输入"):e.$Message.warning("请先点击获取验证码"):e.saveInfoAjax())})},cancelEditPass:function(e){this.$refs[e].resetFields(),this.editPasswordModal=!1},saveEditPass:function(e){var t=this;this.$refs[e].validate(function(r){if(r){t.savePassLoading=!0;var s=t.editPasswordForm;s.id=t.$store.state.user.userId,Object(n["a"])({form:s}).then(function(r){t.savePassLoading=!1,t.editPasswordModal=!1,t.$refs[e].resetFields(),t.$Message.success("Success!")}).catch(function(e){t.$Message.error(e)})}})},init:function(){this.userForm.cellphone="11011011011",this.initPhone="11011011011"},cancelInputCodeBox:function(){this.inputCodeVisible=!1,this.userForm.cellphone=this.initPhone},submitCode:function(){var e=this,t=this;t.checkIdentifyCodeLoading=!0,0===this.securityCode.length?this.$Message.error("请填写短信验证码"):setTimeout(function(){e.$Message.success("验证码正确"),e.inputCodeVisible=!1,e.checkIdentifyCodeLoading=!1},1e3)},hasChangePhone:function(){this.phoneHasChanged=!0,this.hasGetIdentifyCode=!1,this.identifyCodeRight=!1},saveInfoAjax:function(){var e=this;this.save_loading=!0,setTimeout(function(){e.$Message.success("保存成功"),e.save_loading=!1},1e3)}}),mounted:function(){var e=this;Object(n["d"])({form:{action:"get",id:this.$store.state.user.userId}}).then(function(t){e.userList=t.data.data,e.exampleImageSrc=e.$store.state.user.avatorImgPath})},create:function(){}}),_=I,b=(r("qcS0"),r("QdXW"),Object(g["a"])(_,s,o,!1,null,null,null));t["default"]=b.exports},Nygu:function(e,t,r){},QdXW:function(e,t,r){"use strict";var s=r("5G+f"),o=r.n(s);o.a},oPLn:function(e,t,r){},qcS0:function(e,t,r){"use strict";var s=r("Nygu"),o=r.n(s);o.a}}]);